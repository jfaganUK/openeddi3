<link rel="import" href="/bower_components/polymer/polymer.html">
<link rel="import" href="/bower_components/iron-icons/iron-icons.html">
<link rel="import" href="/bower_components/iron-label/iron-label.html">
<link rel="import" href="/bower_components/paper-checkbox/paper-checkbox.html">
<link rel="import" href="/bower_components/iron-flex-layout/iron-flex-layout.html">

<dom-module id="oe-checklist">
    <style>
            .oe-checklist-container {
                margin-top: 10px;
            }
            .oe-checklist-checkbox {
                padding-right: 20px;
                margin-left: 20px;
            }

            :host {
                margin-top: 10px;
            }
        </style>
    <template>
        <div class="oe-checklist-container">
            <template is="dom-repeat" items="{{oe.arrayPrompts}}" as="arrayPrompt">
                <iron-label class="horizontal layout" id="{{_computeAria_labelledby(arrayPrompt, oe)}}">
                    <paper-checkbox for="" role="checkbox" class="oe-checklist-checkbox" on-change="oeCheckboxChanged"
                                    data-arrayid$="{{arrayPrompt.arrayid}}"
                                    checked$="{{_computeChecked(arrayPrompt, response)}}"></paper-checkbox>
                    <div class = "vertical layout">
                        <span>{{ arrayPrompt.prompt }}</span>
                    </div>
                </iron-label>
                <br>
            </template>
        </div>
    </template>
    <script>
        Polymer({
            is: 'oe-checklist',
            properties: {
                oe: {notify: true},
                oeCheckbox: {observer: 'oeCheckboxChanged'},
                response: {notify: true}
            },
            ready: function () {
            },
            oeCheckboxChanged: function (detail, event, sender) {
                var cb = detail.currentTarget;
                var arrayid = cb.attributes['data-arrayid'].value;
                this.set('response.value' + ('.' + arrayid), cb.checked);
                this.fire('change:response');
            },
            _computeAria_labelledby: function (arrayPrompt, oe) {
                return oe.eid + '-' + arrayPrompt.arrayid;
            },
            _computeAria_checked: function (arrayPrompt, response) {
                return response.value[arrayPrompt.arrayid] ? true : false;
            },
            _computeChecked: function (arrayPrompt, response) {
                return response.value[arrayPrompt.arrayid];
            }
        });
    </script>
</dom-module>